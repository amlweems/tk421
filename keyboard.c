#include <stdint.h>
#include "kernel.h"
#include "keyboard.h"

const char KEYBOARD[256] = {
	0,ESC,'1','2','3','4','5','6','7','8','9','0','-','=',0x8,'\t',
	'q','w','e','r','t','y','u','i','o','p','[',']','\n',LCTRL,
	'a','s','d','f','g','h','j','k','l',';','\'','`',LSHIFT,'\\',
	'z','x','c','v','b','n','m',',','.','/',RSHIFT,UNKN,OPTION,' ',
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0
};

char getc(void)
{
	uint8_t keyboard_flags = inportb(0x64);
	while ((keyboard_flags & 0x1) == 0) {
		keyboard_flags =  inportb(0x64);
	}
	char code = inportb(0x60);
    return KEYBOARD[code];
}
